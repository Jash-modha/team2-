<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QR Hunt Rajkot</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { height: 100vh; overflow: hidden; }
    body { 
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
      color: white;
      font-family: system-ui, -apple-system, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      overscroll-behavior: none;
    }
    
    .screen {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(20px);
      border-radius: 24px;
      padding: 2.5rem;
      width: 90vw; max-width: 380px;
      text-align: center;
      border: 1px solid rgba(255,255,255,0.2);
      box-shadow: 0 25px 50px rgba(0,0,0,0.4);
    }
    
    h1 {
      font-size: clamp(1.8rem, 5vw, 2.4rem);
      background: linear-gradient(45deg, #fff, #e0e7ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 1.5rem;
    }
    
    .jumble {
      font-size: clamp(2.5rem, 10vw, 4.2rem);
      font-weight: 800;
      letter-spacing: 0.15em;
      margin: 2rem 0;
      padding: 1.8rem;
      background: rgba(255,255,255,0.2);
      border-radius: 20px;
      cursor: pointer;
      user-select: none;
      transition: all 0.3s;
    }
    .jumble:hover { transform: scale(1.03); }
    
    input {
      width: 100%; padding: 1.3rem; margin: 1.5rem 0;
      font-size: 1.3rem; border: none; border-radius: 16px;
      background: rgba(255,255,255,0.25); color: white;
      text-align: center; backdrop-filter: blur(10px);
    }
    input::placeholder { color: rgba(255,255,255,0.7); }
    input:focus { outline: none; box-shadow: 0 0 0 4px rgba(100,200,255,0.4); }
    
    button {
      width: 100%; padding: 1.3rem; font-size: 1.2rem; font-weight: 700;
      border: none; border-radius: 16px; background: #10b981; color: white;
      cursor: pointer; transition: all 0.3s;
    }
    button:hover { background: #059669; transform: translateY(-2px); }
    
    .error {
      color: #f87171; margin-top: 1rem; font-size: 1.1rem;
      display: none; animation: shake 0.5s;
    }
    @keyframes shake { 0%,100%{transform:translateX(0);} 25%{transform:translateX(-6px);} 75%{transform:translateX(6px);} }
    
    .poster-screen {
      height: 100vh; width: 100vw; position: fixed;
      top: 0; left: 0; background-size: cover !important;
      background-position: center !important; background-repeat: no-repeat !important;
      display: flex; align-items: center; justify-content: center; padding: 2rem;
    }
  </style>
</head>
<body>
  <div id="app"></div>

  <script>
    // ANTI-CHEAT KIOSK MODE
    function initKiosk() {
      document.documentElement.requestFullscreen?.();
      window.history.pushState(null, null, location.href);
      window.onpopstate = () => window.history.pushState(null, null, location.href);
      
      let lastTouchY = 0;
      document.addEventListener('touchstart', e => {
        if (e.touches[0]) lastTouchY = e.touches[0].clientY;
      }, {passive: true});
      document.addEventListener('touchmove', e => {
        if (e.touches[0]?.clientY < lastTouchY - 20) e.preventDefault();
        lastTouchY = e.touches[0]?.clientY;
      }, {passive: false});
    }

    // YOUR EXACT 14 PLACES
    const game = {
      stage: 1,
      places: [
        { name: 'stationary', jumble: 'STATIONARY', password: 'stationary', poster: 'riddle1.jpg' },
        { name: 'generator', jumble: null, password: 'stationary', poster: 'riddle2.jpg' },
        { name: 'signboard', jumble: null, password: 'generator', poster: 'riddle3.jpg' },
        { name: 'garage', jumble: null, password: 'signboard', poster: 'riddle4.jpg' },
        { name: 'securitycabin', jumble: null, password: 'garage', poster: 'riddle5.jpg' },
        { name: 'parking', jumble: null, password: 'securitycabin', poster: 'riddle6.jpg' },
        { name: 'drinkingwater', jumble: null, password: 'parking', poster: 'riddle7.jpg' },
        { name: 'noticeboard', jumble: null, password: 'drinkingwater', poster: 'riddle8.jpg' },
        { name: 'poster', jumble: null, password: 'noticeboard', poster: 'riddle9.jpg' },
        { name: 'library', jumble: null, password: 'poster', poster: 'riddle10.jpg' },
        { name: 'fe', jumble: null, password: 'library', poster: 'riddle11.jpg' },
        { name: 'storageroom', jumble: null, password: 'fe', poster: 'riddle12.jpg' },
        { name: 'footballstamp', jumble: null, password: 'storageroom', poster: 'riddle13.jpg' },
        { name: 'cactusplant', jumble: null, password: 'footballstamp', poster: 'riddle14.jpg' },
        { name: 'warehouse', jumble: null, password: 'cactusplant', poster: 'winner.jpg' }
      ]
    };

    function shuffle(str) {
      return str.split('').sort(() => Math.random() - 0.5).join('');
    }

    function showPasswordScreen() {
      const current = game.places[game.stage - 1];
      const jumbleHtml = current.jumble ? 
        `<div class="jumble" onclick="this.textContent=shuffle(this.textContent.replace(/[^A-Z]/g,''))">${shuffle(current.jumble)}</div>` : '';
      
      document.getElementById('app').innerHTML = `
        <div class="screen">
          <h1>Stage ${game.stage}/15</h1>
          ${jumbleHtml}
          <div style="font-size:1.2rem;color:rgba(255,255,255,0.9);margin:1.5rem 0;">
            ${current.jumble ? 'üîì Unjumble the word' : 'üîì Enter previous place'}
          </div>
          <input type="text" id="passInput" placeholder="Enter password..." autocomplete="off">
          <button onclick="checkPassword()">‚Üí Riddle Poster</button>
          <div class="error" id="errorMsg">‚ùå Wrong! Try again</div>
        </div>`;
      document.getElementById('passInput').focus();
    }

    function showPosterScreen() {
      const current = game.places[game.stage - 1];
      document.getElementById('app').innerHTML = `
        <div class="poster-screen" style="background-image: url('${current.poster}');">
          <div class="screen" style="background:rgba(0,0,0,0.85);">
            <h1 style="color:#60a5fa;margin-bottom:2rem;">Solve Riddle Above üëÜ</h1>
            <div style="font-size:1.3rem;margin-bottom:1.5rem;color:white;">
              Find next QR code
            </div>
            <input type="text" id="passInput" placeholder="Previous place name" autocomplete="off">
            <button onclick="checkPassword()">‚Üí Next QR Code</button>
            <div class="error" id="errorMsg">‚ùå Wrong place name!</div>
          </div>
        </div>`;
      document.getElementById('passInput').focus();
    }

    function checkPassword() {
      const input = document.getElementById('passInput').value.trim().toLowerCase();
      const current = game.places[game.stage - 1];
      const errorMsg = document.getElementById('errorMsg');
      
      if (input === current.password.toLowerCase()) {
        errorMsg.style.display = 'none';
        
        // Toggle between password screen ‚Üí poster ‚Üí next QR
        if (document.querySelector('.poster-screen')) {
          // On poster screen, go to next stage
          game.stage++;
          if (game.stage > 15) {
            document.body.innerHTML = `
              <div style="height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#10b981,#059669);color:white;text-align:center;padding:2rem;">
                <div class="screen" style="max-width:500px;">
                  <h1 style="font-size:4rem;margin-bottom:2rem;">üèÜ WINNER! üèÜ</h1>
                  <p style="font-size:1.8rem;">QR Hunt Complete!</p>
                  <p style="font-size:1.4rem;margin-top:1rem;">Show to organizers</p>
                </div>
              </div>`;
            return;
          }
          showPasswordScreen();
        } else {
          // On password screen, show poster
          showPosterScreen();
        }
      } else {
        errorMsg.style.display = 'block';
        document.getElementById('passInput').value = '';
        document.getElementById('passInput').focus();
      }
    }

    // START
    window.addEventListener('load', () => {
      initKiosk();
      
      const params = new URLSearchParams(window.location.search);
      game.stage = parseInt(params.get('stage')) || 1;
      
      if (game.stage < 1 || game.stage > 15) {
        document.getElementById('app').innerHTML = '<div class="screen"><h1 style="color:#f87171;">Invalid QR Code</h1></div>';
        return;
      }
      
      showPasswordScreen();
    });
  </script>
</body>
</html>
